<!doctype html>
<html>
<head>
<!-- 
 -->
<meta charset="utf-8">
<title>Intelligent_chat</title>
<link rel="stylesheet" href="dist/css/layui.css" media="all">
</head>
<body>
<!-- <script src="https://cdn.ronghub.com/RongIMLib-2.2.8.min.js"></script>   -->
<script type="text/javascript" src="dist/layui.js"></script>
<!-- <script src="node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script> -->
<script type="text/javascript" src="dist/lay/modules/jquery.js"></script>
<!-- <script src="index.js" type="text/javascript"></script> -->


<!-- <script type="text/javascript" src="index.js"></script> -->
<script src="js/socket.io.js"> </script>
<!-- <script type="text/javascript" src=""></script> -->
<script>
layui.use('layim', function(layim){
  layim.config({
    init: {
      // 配置客户信息
      mine: {
        "username": "访客" //我的昵称
        , "id": -1 //我的ID
        , "status": "online" //在线状态 online：在线、hide：隐身
        , "avatar": "images/my_avatar.jpeg" //我的头像
      }
    }
    ,brief: true //是否简约模式（如果true则不显示主面板）
    ,initSkin: 'IC_background.jpeg'
    ,chatLog: layui.cache.dir + 'css/modules/layim/html/chatLog.html' //聊天记录页面地址，若不开启，剔除该项即可
  }).chat({
    name: 'Intelligent_Chat'
    ,type: 'kefu'
    ,avatar: 'images/机器人头像.jpg'
    ,id: -2
  });

   //建立WebSocket通讯
  //注意：如果你要兼容ie8+，建议你采用 socket.io 的版本。下面是以原生WS为例
  var socket = io('ws://localhost:8000');
  // 监听发送的消息 
  layim.on('sendMessage', function(data){
    // var mine = res.mine; // Include my information & my sent message
    var To = data.to; // the replier information
    if(To.type === 'kefu'){
      layim.setChatStatus('<span style="color:#FF5722;">对方正在输入。。。</span>');
    }
    socket.emit('chatMessage', data)
    // content = data.mine.content;
  
  });
  // 监听接受的消息
  socket.on('reply', function(data) {
    data.mine = false;
    layim.getMessage(data);
  });
  
});
</script>

</body>
</html>
